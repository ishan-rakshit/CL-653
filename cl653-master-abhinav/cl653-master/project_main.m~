function project_main
    randn('state', 0);
    sig_1 = 0.2;
    sig_2 = 7E-3;
    sig_r = 50;
    sig_theta = 0.1;
    sig_phi = 0.1;
    T_s = 0.1;
    N = 1000;
    
    Q_d = diag([0 sig_1^2 0 sig_1^2 0 sig_1^2 sig_2^2]);
    w_d = sqrt(Q_d)*randn(7, N);
    disp('Q_d (sample) is:');
    disp(cov(w_d'));
    R = diag([sig_r^2 sig_theta^2 sig_phi^2]);
    v = sqrt(R)*randn(3, N);
    disp('R (sample) is:');
    disp(cov(v'));
    
    x_0 = [1000; 0; 2650; 150; 200; 0; 3];
    y = [];
    for k = 1:N
       [t, x_temp] = ode45(@project_f, [0, T_s], x_0);
       x(:,k) =  x_temp(end,:)' + w_d(:,k);
       y(:,k) = project_g(x(:,k)) + v(:,k);
       x_0 = x(:,k);
    end
    
    % PLOT
    x_0 = [1000; 0; 2650; 150; 200; 0; 3];
    figure;
    % state 1
    subplot(4,4,1)
    plot(0:N, [x_0(1), x(1,:)], 'r')
    title('x_1')
    subplot(4,4,2)
    plot(0:N, [x_0(2), x(2,:)], 'r')
    title('x_2')
    subplot(4,4,3)
    plot(0:N, [x_0(3), x(3,:)], 'r')
    title('x_3')
    subplot(4,4,4)
    plot(0:N, [x_0(4), x(4,:)], 'r')
    title('x_4')
    subplot(4,4,5)
    plot(0:N, [x_0(5), x(5,:)], 'r')
    title('x_5')
    subplot(4,4,6)
    plot(0:N, [x_0(6), x(6,:)], 'r')
    title('x_6')
    subplot(4,4,7)
    plot(0:N, [x_0(7), x(7,:)], 'r')
    title('x_7')
    subplot(4,4,8)
    plot(1:N, y(1,:), 'r')
    subplot(4,4,9)
    plot(1:N, y(2,:), 'r')
    subplot(4,4,10)
    plot(1:N, y(3,:), 'r')
    subplot(4,4,11)
%     
%     subplot(4,4,12)
%     
%     subplot(4,4,13)
%     
%     subplot(4,4,14)
%     
%     subplot(4,4,15)
end